- name: Zsh
  hosts: all
  gather_facts: true
  vars_files:
    - ../vars/main.yml

  tasks:
  # Dependencies
  - name: Dependencies
    tags: [init, update]
    ansible.builtin.include_tasks:
      file: ../tasks/packages.yml
    vars:
      package_list: "{{ zsh_dependencies }}"
      package_type: dependencies

  # Shell
  - name: Set zsh as default shell
    tags: init
    ansible.builtin.user:
      name: "{{ ansible_user_id }}"
      shell: /bin/zsh

  # Antidote
  # git clone --depth=1 https://github.com/mattmc3/antidote.git ${ZDOTDIR:-$HOME}/antidote
  - name: Antidote
    block:

    - name: Antidote - Install
      tags: [init, update]
      ansible.builtin.git:
        repo: https://github.com/mattmc3/antidote.git
        dest: "/home/{{ ansible_user_id }}/.local/antidote"
        depth: 1
